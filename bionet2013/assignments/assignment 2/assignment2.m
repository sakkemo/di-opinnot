ASH1='CTGATTAGTTTTCCGTTTTAGGATATTGACGCCAAGCGTGCGTCTGATTTCTACGATATGTCTCTAATTTTGGAAGGGCCATTTTATTTTTGAGGATTGGGCTGATCATTTTCCTTACGTGGATTGAGCCAGCAATACAGATCATTATTAAACTGTTTTGTACATGATGTTAGTATATAATCGTAAAGCTTTTCTAATATGTATACCTTATACATGGAACTCCACAGAACTTGCAAACATACCAAAAATCCTTTATTCTTGTTCACTCATTTTACATCAAAAAATAATATTTCAGTTATTAAGGAAAATAAAAAAATAGATTAGAGAAGCATTTTGAAGAAATAGTATATTCTTTTATTGAACCTAAGAGCGTGATATTTTTACTCGAAATAAAATACGAAAAATCTATACACTCATCTTTCCGACTACTATTGGCTCCTGCTCAAAAAAAGAGGGAAAAAAAGCTCCAAAATTCTATCTTTTCCTATCGCTCCTGTCCTATCCTTATTACGTTCATTACTATTTTAATACTATCCATTCTTTTATTTTCAGTCTAAAAAAAACATTTCTCATAACGGGAAAAGCAAAAAA'
GAL10='CCATTTATATATCTGTTAATAGATCAAAAATCATCGCTTCGCTGATTAATTACCCCAGAAATAAGGCTAAAAAACTAATCGCATTATCATCCTATGGTTGTTAATTTGATTCGTTAATTTGAAGGTTTGTGGGGCCAGGTTACTGCCAATTTTTCCTCTTCATAACCATAAAAGCTAGTATTGTAGAATCTTTATTGTTCGGAGCAGTGCGGCGCGAGGCACATCTGCGTTTCAGGAACGCGACCGGTGAAGACGAGGACGCACGGAGGAGAGTCTTCCGTCGGAGGGCTGTCGCCCGCTCGGCGGCTTCTAATCCGTACTTCAATATAGCAATGAGCAGTTAAGCGTATTACTGAAAGTTCCAAAGAGAAGGTTTTTTTAGGCTAAGATAATGGGGCTCTTTACATTTCCACAACATATAAGTAAGATTAGATATGGATATGTATATGGTGGTAATGCCATGTAATATGATTATTAAACTTCTTTGCGTCCATCCAAAAAAAAAGTAAGAATTTTTGAAAATTCAATATAA'
MET16='CATCTTATCGGTTTATTTTTCTATATATTTGCCTCTTTCTCAAACAGGAGTTAGTAGTTAAAAGTACGAAGTTCTTGTTCTTTAATGCGCGCTGACAAAAGAATTGGATAAAAGAGAATGGTGGGGGGACAAGAAGGAAATTTGTCCTAGTTTAACATGAATGGCATCTTGTTACCGGGTGGACATCACCTATTGATTCTAAATATCTTTACGGTTTATCATACTGTTCTTTATTCCGTCGTTATTCTTTTTATTTTTATCATCATTTCACGTGGCTAGTAAAAGAAAAGCCACAACATGACTCAGCAAATCTCGACAAAGTAAAAGCTCATAGAGATAGTATTATATTGATATAAAAAAAGTATACTGTACTGTTTGTAACCTTTTCAATGCTTTAAGATCAAAACTAAGGCCAGCAAAGGTATCAACCCATAGCAACTCATAAA'
HO='CATTTTTGTTTCTTTTGGACAAATGTTGTTTGCATTTATGATCCGTTATATTTTGATCTAATGTAGAGTTGCACGTAGTTCTTACTGGCAAAGAAATCGATGCATACCAAAAAAGAATAAAGGTGATATTTGATCTTTACCGTTTAGTTCCAACGTAAAATTGTGCCTTTGGACTTAAAATGGCGTGGCAGAACTAACTCTTTATTTTTCCAAATCAGAAAAATTAATATGTTTTGCCGCGTTAAAACCTACATCAAAAAAGGCGGATCAAGATGTATGAAAGAAAGTGCGTAGAATAACGAACATTCATAGCTGTTCTGGAGGCTTTACAAAAGGTAATCTTTGTTAGGTGCGATTTTATCCGAAAAGCAATTACTCTCTATGTTAGTCATACAAACTGACTTCTGTGAGAGAATTATTTTCATATCAACGTAAGATCACATGGTTCCTTTATCAAGTACTACTATCATTCCATTATATGACCTATTTACTTCTTGAATCTTAGAGCTCATAATTCAAGCAAGTTGCGGAGCTAAGAATTTCACATGTTGTTGAACTTAACAATCTTCATTATACCCAATCGCTGCGTGCTGGAATTATGTTAAAAGTTACATCCTTTTTTTCATTTTTCCCTACGCTCAGGGCACTGTACTGCCCGTGCCTGCGATGAGATACATCAATTTAAAAAAAAAACCAGCATGCTATAATGCTGGAGCAAAAATTTCAATCAGAAATAGAAAAGACCTCAACAGTAATTAACCCAAAGGGGTATCAAATAATCGATGTGCTTTTTCACTCTACGAATGATCTGTGAGAAACTGATTTGGGCCGAATCGCGTAAAAAGTTTGATTCGTGGCGGCTAATGTCTGAGGGGCTCCAACAGGCTCGTAGAGCCTCGTTTCTTGAGGGCACAAAATGTCCAGGTAATATTCCCAAGAAAGAACCGCAGAGTGCTTTGATAAATCGGTTACAGGTCTTAACGTAGGTTTTGTCTCGCTAATTGCTATTGAGTAAGTTCGATCCGTTTGGCGTCTTTTGGGGTGTAACGCCAAACTTATTACTTTTCCTATTTGAGGTTGGTATTGATTGTTGTCAAAGAATGAAAATATACACAAACGCCACAATATACGTACCAGGTTCACGAAAACTGATCGTATGGTTCATACCCTGACTTGGCAAACCTAATGTGACCGTCGCTGATTAGCGGATCACGAAAAGTGATCTCGATACAATTAGAGGATCCACGAAAATGATGTGAATGAATACATGAAAGATTCATGAGATCTGACAACATGGTAGACGTGTGTGTCTCATGGAAATTGATGCAGTTGAAGACATGTGCGTCACGAAAAAAGAAATCAATCCTACACAGGGCTTAAGGGCAAATGTATTCATGTGTGTCACGAAAAGTGATGTAACTAAATACACGATTACCATGGAAATTAACGTACCTTTTTTGTGCGTGTATTGAAATATTATGACATATTACAGAAAGGGTTCGCAAGTCCTGTTTCTATGCCTTTCTCTTAGTAATTCACGAAATAAACCTATGGTTTACGAAATGATCCACGAAAATCATGTTATTATTTACATCAACATATCGCGAAAATTCATGTCATGTCCACATTAACATCATTGCAGAGCAACAATTCATTTTCATAGAGAAATTTGCTACTATCACCCACTAGTACTACCATTGGTACCTACTACTTTGAATTGTACTACCGCTGGGCGTTATTAGGTGTGAAACCACGAAAAGTTCACCATAACTTCGAATAAAGTCGCGGAAAAAAGTAAACAGCTATTGCTACTCAAATGAGGTTTGCAGAAGCTTGTTGAAGCATGATGAAGCGTTCTAAACGCACTATTCATCATTAAATATTTAAAGCTCATAAAATTGTATTCAATTCCTATTCTAAATGGCTTTTATTTCTATTACAACTATTAGCTCTAAATCCATATCCTCATAAGCAGCAATCAATTCTATCTATACTTTAAA'

seqs{1} = ASH1;
seqs{2} = GAL10;
seqs{3} = MET16;
seqs{4} = HO;

%%
F.data{1} = [[...
 0.0...
 0.0...
 0.391...
 0.376...
 0.81...
 0.006...
 0.223...
 0.505...
 0.0...
 0.015]
 [0.73...
 0.962...
 0.08...
 0.189...
 0.0...
 0.048...
 0.503...
 0.002...
 0.037...
 0.002]
[0.039...
 0.0...
 0.447...
 0.342...
 0.189...
 0.037...
 0.037...
 0.311...
 0.828...
 0.852]
 [0.231...
 0.038...
 0.082...
 0.093...
 0.001...
 0.909...
 0.237...
 0.182...
 0.134...
 0.132]]

F.data{2} = [
[ 0.245...
 0.029...
 0.011...
 0.986...
 0.004...
 0.018...
 0.017...
 0.0]
[ 0.002...
 0.003...
 0.977...
 0.0...
 0.938...
 0.018...
 0.008...
 0.007]
[ 0.737...
 0.081...
 0.005...
 0.012...
 0.006...
 0.96...
 0.004...
 0.985]
[ 0.016...
 0.888...
 0.006...
 0.002...
 0.052...
 0.003...
 0.971...
 0.008...
 ]]

F.data{3} = [
[ 0.0...
 0.001...
 0.056...
 0.642...
 0.185...
 0.199...
 0.574...
 0.142...
 0.641...
 0.116...
 0.058...
 0.06...
 0.03...
 0.186...
 0.0...
 0.0...
 0.0...
 0.571...
 ]
[ 0.942...
 0.015...
 0.044...
 0.126...
 0.427...
 0.142...
 0.071...
 0.568...
 0.0...
 0.367...
 0.196...
 0.181...
 0.67...
 0.426...
 0.985...
 0.999...
 0.0...
 0.095...
 ]
[ 0.0...
 0.984...
 0.884...
 0.101...
 0.373...
 0.186...
 0.299...
 0.218...
 0.015...
 0.316...
 0.0...
 0.472...
 0.21...
 0.187...
 0.015...
 0.0...
 0.958...
 0.178...
 ]
[ 0.057...
 0.0...
 0.015...
 0.131...
 0.015...
 0.472...
 0.056...
 0.071...
 0.344...
 0.201...
 0.747...
 0.287...
 0.09...
 0.201...
 0.0...
 0.0...
 0.042...
 0.155]]

F.data{4} = [
[ 0.072...
 0.099...
 0.005...
 0.017...
 0.052...
 0.183...
 0.206...
 0.175]
[ 0.148...
 0.055...
 0.857...
 0.049...
 0.031...
 0.087...
 0.197...
 0.164]
[ 0.163...
 0.833...
 0.0...
 0.066...
 0.853...
 0.619...
 0.116...
 0.164]
[ 0.618...
 0.012...
 0.138...
 0.868...
 0.063...
 0.111...
 0.481...
 0.498]]

 F.selite{1} = 'ASH1'
  F.selite{2} = 'CBF1'
 F.selite{3} = 'GAL4'
 F.selite{4} = 'SWI5'
 F.selite{5} = 'GAL80'


%%
for i = 1:4
    for j = 1:4
        Fs = F.data{i};
        seq = basepairs2num(seqs{j});
        score = PSWM_MotifLocator(seq,Fs,0.25*ones(1,4),0,[],[]);
        A(i,j) = max(score);
    end
end
% A: rows -> frequency matrices -> what protein likes to bind to
% A: cols -> promoter sequences -> what controls the transcription
%%
% construct adjacency matrix
% order: ASH1 CBF1 GAL4 SWI5 GAL80
thresholds = [900 500 400 300 200 100 80 50 20 0.5];
for i=1:length(thresholds)
threshold = thresholds(i);
C = A(:,[1 4 3 2 1]); C(5,:) = 0; C = C>threshold;
C(1,1)=0;C(2,2)=0;C(3,3)=0;C(4,4)=0;C(5,5)=0;
names = F.selite;
bg = biograph(C, names);
%view(bg)

true_network = ...
     [0     1     0     0     0;
     0     0     1     0     0;
     0     0     0     1     0;
     1     1     0     0     1;
     0     0     0     0     0;];
% view(biograph(true_network, names))
 
 true_positive_ratio = sum(sum((C+true_network) == 2))/sum(true_network(:));
 false_positive_ratio = sum(sum(C-true_network==1))/sum(true_network(:)==0);
 Y(i,:) = [threshold, true_positive_ratio, false_positive_ratio];
end